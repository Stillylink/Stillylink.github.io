<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Анонимное общение — StillyLink</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/style.css">
    <style>
.anon-wrapper {
    display: flex;
    gap: 30px;
    justify-content: center;
    margin-top: 30px;
    flex-wrap: wrap;
}

/* ===== Общая карточка ===== */
.anon-card {
    width: 300px;                /* Уже (было 380px) */
    min-height: 350px;           /* Длиннее */
    border-radius: 14px;
    overflow: hidden;
    cursor: pointer;
    transition: 0.25s;
    border: 1px solid #dcdcdc;
    display: flex;
    flex-direction: column;
}

/* Hover */
.anon-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 14px rgba(0,0,0,0.15);
}

/* =====  Верхняя часть ===== */
.anon-card-top {
    background: #000;
    color: #fff;
    padding: 25px 20px;
    height: 120px;               /* Чуть выше */
    display: flex;
    justify-content: center;     /* Центрируем */
    align-items: center;         /* Центрируем по вертикали */
    text-align: center;          /* Центрируем текст */
    font-size: 18px;
    font-weight: bold;
}

/* ===== нижняя часть ===== */
.anon-card-bottom {
    background: #fff;
    color: #000;
    padding: 20px;
    font-size: 15px;
    line-height: 1.45;
    text-align: center;          /* Тоже центрируем, выглядит аккуратнее */
    flex: 1;                      /* Растягивает вниз */
}
        .section h2 {
    color: #000 !important;
}
    </style>
</head>
<body>

<header class="navbar">
    <div class="logo">StillyLink</div>

    <nav class="nav-links">
        <a href="/">Главная</a>
        <a href="/chats/">Чаты</a>
        <a href="/index.html#create-chat">Создать чат</a>
        <a href="/anonymous/">Анонимное общение</a>
        <a href="/login/" class="register-btn">Регистрация</a>
    </nav>

    <div class="user-avatar hidden" onclick="toggleUserMenu()">
        <span>U</span>
    </div>

    <div class="user-menu">
        <a href="/profile/">Профиль</a>
        <a href="/mychats/">Мои чаты</a>
        <a href="#" id="logoutBtn">Выйти</a>
    </div>

    <div class="nav-toggle" onclick="toggleMenu()">☰</div>
</header>

<div class="menu-overlay"></div>

<section class="section">
    <h2>Анонимное общение</h2>

<div class="anon-wrapper">

    <div class="anon-card" onclick="location.href='/anonymous/private/'">
        <div class="anon-card-top">
            Анонимный чат один на один
        </div>
        <div class="anon-card-bottom">
            Общение между двумя пользователями без регистрации и без ввода ника.
        </div>
    </div>

    <div class="anon-card" onclick="location.href='/anonymous/group/'">
        <div class="anon-card-top">
            Групповой анонимный чат
        </div>
        <div class="anon-card-bottom">
            Войдите в общий чат с ником и общайтесь с неограниченным количеством людей.
        </div>
    </div>

</div>
</section>

<footer class="footer">
    <p>© 2025 StillyLink. Все права защищены.</p>
</footer>

<!-- ================= FIREBASE ================= -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
import { 
    getAuth,
    onAuthStateChanged,
    signOut
} from "https://www.gstatic.com/firebasejs/12.6.0/firebase-auth.js";

// --- CONFIG ---
const firebaseConfig = {
    apiKey: "AIzaSyBWlR4QWdnbqXLKKaftEAzhXneTmV9xXX0",
    authDomain: "stillylink-f1d0f.firebaseapp.com",
    projectId: "stillylink-f1d0f",
    storageBucket: "stillylink-f1d0f.appspot.com",
    messagingSenderId: "772070114710",
    appId: "1:772070114710:web:939bce83e4d3be14bdc9b7"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);

// UI элементы
const regBtn = document.querySelector(".register-btn");
const avatar = document.querySelector(".user-avatar");
const avatarLetter = document.querySelector(".user-avatar span");
const userMenu = document.querySelector(".user-menu");
const logoutBtn = document.getElementById("logoutBtn");

// === Локальное восстановление состояния ===
const savedLogin = localStorage.getItem("isLoggedIn");
const savedLetter = localStorage.getItem("avatarLetter");

if (savedLogin === "true" && savedLetter) {
    regBtn.classList.add("hidden");
    avatar.classList.remove("hidden");
    avatarLetter.textContent = savedLetter;
}

// --- Авторизация ---
onAuthStateChanged(auth, user => {
    if (user) {
        const letter = user.email?.charAt(0).toUpperCase() || "U";

        regBtn.classList.add("hidden");
        avatar.classList.remove("hidden");
        avatarLetter.textContent = letter;

        localStorage.setItem("isLoggedIn", "true");
        localStorage.setItem("avatarLetter", letter);

    } else {
        regBtn.classList.remove("hidden");
        avatar.classList.add("hidden");

        localStorage.removeItem("isLoggedIn");
        localStorage.removeItem("avatarLetter");
    }
});

// --- Выход ---
logoutBtn.onclick = (e) => {
    e.preventDefault();

    localStorage.removeItem("isLoggedIn");
    localStorage.removeItem("avatarLetter");

    signOut(auth).then(() => window.location.reload());
};
</script>

<!-- ============== МЕНЮ НАВИГАЦИИ ============== -->
<script>
function toggleMenu() {
    const menu = document.querySelector(".nav-links");
    menu.classList.toggle("open");
}

document.addEventListener("click", function(e) {
    const menu = document.querySelector(".nav-links");
    const toggle = document.querySelector(".nav-toggle");

    if (!menu.classList.contains("open")) return;
    if (menu.contains(e.target) || toggle.contains(e.target)) return;

    menu.classList.remove("open");
});
</script>

<!-- ============== МЕНЮ АВАТАРКИ ============== -->
<script>
function toggleUserMenu() {
    document.querySelector(".user-menu").classList.toggle("open");
}

document.addEventListener("click", function(e) {
    const menu = document.querySelector(".user-menu");
    const avatar = document.querySelector(".user-avatar");

    if (!menu.classList.contains("open")) return;
    if (menu.contains(e.target) || avatar.contains(e.target)) return;

    menu.classList.remove("open");
});
</script>

</body>
</html>
